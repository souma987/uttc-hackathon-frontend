# ハッカソンフロントエンド
Next.js で実装された、UTTC 8期 ハッカソンのためのプロジェクトのフロントエンドです。

## 機能
API 呼び出しなどの重要なロジックを UI から切り分けて `/lib` 内のコードに統一し 、また UI はローディング中のスケルトンなどを用いてスムーズにレンダリングされるよう務めました。

- **多言語対応** - フッターから日英切り替え可能です。
- **AI 機能** - 商品説明入力中に、追記したほうが良いと思われる項目を LLM が提案してくれます。
- **画像保存** - 画像保存は Firebase Storage を利用しています。Firebase 側でアクセス規則を指定することで、ログイン時のみアップロードを許可して、また
- **サーバーサイド認証** - クライアントのログイン状況を監視し、変更があるたびにトークンをサーバーに送って Http only の cookie に保存しています。これにより、注文詳細などの、バックエンド側で認証が実装されている API を使ったページもサーバーサイドレンダリングができます。

### src ディレクトリ構造
- **app** - Next.js の App Router。すべてのルートが定義されている。
  - **api/update-auth-token** - サーバー側でユーザーを判定するためにサーバーと Firebase 認証トークンを共有するための API。受け取ったトークンは HTTP only の Cookie として保存される
  - **auth** - ログイン及び新規登録ページ
  - **market** - フリマアプリトップページ
    - **listings** - 出品関連
      - **[listingId]** - 出品詳細ページ
      - **new** - 新規出品ページ
    - **messages** - DM 一覧ページ
      - **[userId]** - 特定の相手とのDMページ
    - **orders** - 自分の取引一覧ページ
      - **[orderId]** - 取引詳細ページ
    - **users/[userId]** - 各ユーザープロフィール
- **components** - 再利用可能なコンポーネント
  - **ui** - shadcn/ui のコンポーネント
- **hooks** - 再利用可能なカスタムフック
- **i18n** - 多言語対応のためのコード
- **lib** - UI に関連しないデータ処理などのコード。サーバーからもブラウザからも使う
  - **api** - バックエンドとの通信を axios で行う。ロジックは含まず、通信とエンコード・デコードのみ行う
  - **firebase** - Firebase 関連の設定。ロジック等は含まない。
    - **common** - ブラウザとサーバーで処理を共通化できるよう、Auth をエクスポートしている。ブラウザの場合は自動で初期化され、サーバー側は明示的に初期化する。
    - **browser** - ブラウザ側でのみ使うコード。Auth と Storage を設定している。
    - **server** - サーバー側でのみ使うコード。Cookie からトークンを取得して Auth を初期化する。
  - **services** - データ処理のロジックを含む。
